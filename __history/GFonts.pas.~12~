unit GFonts;

interface
uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, OpenGL, DGLUT, Textures,command;


type
  FFont = record
    x,y,sim,Leg,a: integer;
 end;

//////----------------****************************************************---------------------------////

var
  cis:integer;
  Sim:array[1..196] of string;
  FontI:array[1..196] of FFont;

//////----------------****************************************************---------------------------////

procedure Smart_Symvol(a:char);
procedure MassivTexta();
procedure Enable_sun();
procedure Disable_sun();
procedure Render_Symvol(Simvol:string; Size,X,Y,D,S:integer;  R,G,B:Byte);
procedure Symvol_Button(Simvol:string; Size,X,Y,D,S:integer;  R,G,B:Byte; Key:integer);
procedure R3D_To_2D(ClientWidth, ClientHeight:integer);
procedure R2D_To_3D();


implementation
uses GUI,Resurce;


procedure Enable_sun();
begin
  glEnable(GL_LIGHTING);
  glEnable(GL_LIGHT0);
end;

//////----------------****************************************************---------------------------////

procedure Disable_sun();
begin
  glDisable(GL_LIGHTING);
  glDisable(GL_LIGHT0);
end;

//////----------------****************************************************---------------------------////

procedure Enable_Atest();
begin
  glEnable(GL_DEPTH_TEST);
  glEnable(GL_NORMALIZE);
  glEnable(GL_COLOR_MATERIAL);
  glShadeModel(GL_SMOOTH);
end;

//////----------------****************************************************---------------------------////

procedure Disable_Atest();
begin
  glDisable(GL_NORMALIZE);
  glDisable(GL_COLOR_MATERIAL);
  glDisable(GL_DEPTH_TEST);
end;

//////----------------****************************************************---------------------------////

procedure SpriteButton(PX,PY,SX,SY:real;Pict:Uint; Key:integer);
var X,Y:integer;
begin
  GetCursorPos(Point);
  X:=-Form1.Left +Point.X;
  Y:=-Form1.Top-15  +point.Y;

  RenderSprite(PX,PY,SX,SY,0,Pict);
    if (X<px+sx) and (X>px-sx) then
      if (Y<py+sy) and (Y>py-sy) then
        if (GetAsyncKeyState(VK_LBUTTON)<>0) and (MBL=false) then
          begin
          if Key=10 then
            begin
              // RayCast();
            end;
          if Key<>10 then
            begin
             // MenuG.Stay:=Key;
            end;
            MBL:=true;
      end;
end;

//////----------------****************************************************---------------------------////


procedure MassivTexta();
  var I,Y,B,J:integer;
  Fi:textfile;
begin
assignfile(fi,'GRE\Scripts\symvols.abc');  reset(fi);
readln(fi,Y);
for I := 1 to Y do
begin
  readln(fi, Sim[I]);
end;


{  Sim[119]:= '1';Sim[120]:= '2';
  Sim[121]:= '3';Sim[122]:= '4';
  Sim[123]:= '5';Sim[124]:= '6';
  Sim[125]:= '7';Sim[126]:= '8';
  Sim[127]:= '9';Sim[128]:= '0';
  Sim[129]:= 'ф';Sim[130]:= 'ш';
  Sim[131]:= 'х';Sim[132]:= 'ъ';
  Sim[133]:= 'ц';Sim[134]:= 'ь';
  Sim[135]:= 'ч';Sim[136]:= 'ю';
  Sim[137]:= 'ъ';Sim[138]:= ''+Chr(39)+'';
  Sim[139]:= 'ы';Sim[140]:= '#';
  Sim[141]:= 'ь';Sim[142]:= '^';
  Sim[143]:= 'э';Sim[144]:= ']';
  Sim[145]:= 'ю';Sim[146]:= '>';
  Sim[147]:= 'я';Sim[148]:= '';  }
{  Sim[149]:= '|';Sim[150]:= '1';
  Sim[151]:= '2';Sim[152]:= '3';
  Sim[153]:= '4';Sim[154]:= '5';
  Sim[155]:= '6';Sim[156]:= '7';
  Sim[157]:= '8';Sim[158]:= '9';
  Sim[159]:= '0';Sim[160]:= '©';
  Sim[161]:= '®';Sim[162]:= '™';
  Sim[163]:= '±';Sim[164]:= '&';
  Sim[165]:= '÷';Sim[166]:= ' ';
  Sim[167]:= '→';Sim[168]:= '≈';

  Sim[169]:= '4';Sim[170]:= '5';
  Sim[171]:= '6';Sim[172]:= '7';
  Sim[173]:= '8';Sim[174]:= '9';
  Sim[175]:= '0';Sim[176]:= '©';
  Sim[177]:= '®';Sim[178]:= '™';
  Sim[179]:= '±';Sim[180]:= '&';
  Sim[181]:= '÷';Sim[182]:= ' ';
  Sim[183]:= '→';Sim[184]:= '≈';
  Sim[185]:= '®';Sim[186]:= '™';
  Sim[187]:= '±';Sim[188]:= '&';
  Sim[189]:= '÷';Sim[190]:= ' ';
  Sim[191]:= '→';Sim[192]:= '≈';
  Sim[193]:= '÷';Sim[194]:= ' ';
  Sim[195]:= '→';Sim[196]:= '≈';  }

Sim[196]:= ' ';



B:=196;
  for Y := 1 to 14 do
      for I := -14 to -1 do
        begin
          FontI[B].x:=I*(-1);
          FontI[B].y:=Y;
          B:=B-1;
        end;

end;

//////----------------****************************************************---------------------------////   

procedure Smart_Symvol(a:char);
  var I:integer;
begin
  for I := 1 to 196 do
    begin
      if a = Sim[I] then
        begin
          cis:=I;
        end;
    end;
end;

//////----------------****************************************************---------------------------////

procedure Render_Symvol(Simvol:string; Size,X,Y,D,S:integer; R,G,B:Byte);
  var BB,I:Integer;
      Text:FFont;
begin
  Text.Leg:=Length(Simvol);
  glPushMatrix;
  Disable_sun();
  glBindTexture(GL_TEXTURE_2D, FontF);
  glColor(R,G,B);
    for I := 1 to Text.Leg do
      begin
        Smart_Symvol(Simvol[I]);
        BB:=cis;
          glBegin(GL_Quads);
            glTexCoord((FontI[BB].x-1)/14, (FontI[BB].y)/14);   glVertex((-1*Size)+x+((Size*1.5)*I), (-1*Size)+Y);
            glTexCoord((FontI[BB].x-1)/14, (FontI[BB].y-1)/14); glVertex((-1*Size)+X+((Size*1.5)*I), (1*Size)+Y);
            glTexCoord((FontI[BB].x)/14,   (FontI[BB].y-1)/14); glVertex((1*Size)+X+((Size*1.5)*I),  (1*Size)+Y);
            glTexCoord((FontI[BB].x)/14,   (FontI[BB].y)/14);   glVertex((1*Size)+X+((Size*1.5)*I),  (-1*Size)+Y);
          glEnd;
      end;
  glColor(255,255,255);
  GLpOPmATRIX;
end;

//////----------------****************************************************---------------------------////

procedure Symvol_Button(Simvol:string; Size,X,Y,D,S:integer; R,G,B:Byte; Key:integer);
  var BB,I:Integer;
      Text:FFont;
      MX,MY:integer;

begin

  GetCursorPos(Point);
  MX:=-Form1.Left +Point.X;
  MY:=-Form1.Top-15  +point.Y;
  Text.Leg:=Length(Simvol);
    glPushMatrix;
        if (MX<(-1*Size)+x+((Size*1.5)*(Text.Leg+1))) and (MX>(-1*Size)+x+((Size*1.5)*1)) then
          if (MY<(1*Size)+Y) and (MY>(-1*Size)+Y) then
            begin
              R:=255;
              G:=255;
              B:=0;
            end;
          Render_Symvol(Simvol,Size,X,Y,D,S,R,G,B);
    GLpOPmATRIX;
      if (MX<(-1*Size)+x+((Size*1.5)*(Text.Leg+1))) and (MX>(-1*Size)+x+((Size*1.5)*1)) then
        if (MY<(1*Size)+Y) and (MY>(-1*Size)+Y) then
          if (GetAsyncKeyState(VK_LBUTTON)<>0) and (MBL=false) then
            begin
               provrka:= key;
              if Key=5 then
                begin
                  //M:=5;
                  
                end;
              if Key<>10 then
                begin
                  //  MenuG.Stay:=Key;
                end;
       MBL:=true;
    end;
end;

//////----------------****************************************************---------------------------////

procedure R3D_To_2D(ClientWidth, ClientHeight:integer);
begin
  glPushMatrix;
  glLoadIdentity;
  glMatrixMode(GL_PROJECTION);
  glPushMatrix;
  glLoadIdentity;
  gluOrtho2D(0,ClientWidth, ClientHeight,0);
  glMatrixMode(GL_MODELVIEW);
end;

//////----------------****************************************************---------------------------////

procedure R2D_To_3D();
begin
  glMatrixMode(GL_PROJECTION);
  glPopMatrix;
  glMatrixMode(GL_MODELVIEW);
  glPopMatrix;
end;

end.